/**
 * Generate Excel Template for Employee Import
 * Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á Excel template file ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
 */

import xlsx from 'xlsx'
import fs from 'fs'
import path from 'path'
import { fileURLToPath } from 'url'

const __filename = fileURLToPath(import.meta.url)
const __dirname = path.dirname(__filename)

// Define columns (Thai headers)
const columns = [
  '‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
  '‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
  '‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
  '‡πÄ‡∏û‡∏®',
  '‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á',
  '‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
  '‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©',
  '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô',
  '‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',
  '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£',
  'Email',
  'Email Build',
  'PassWord E-mail Buildme',
  '‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô',
  '‡∏ß‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏á‡∏≤‡∏ô',
  '‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î',
  '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô',
  '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà',
  '‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô',
  '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£',
  '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà',
  '‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà',
  '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà',
  '‡∏ã‡∏≠‡∏¢/‡∏ï‡∏£‡∏≠‡∏Å',
  '‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà',
  '‡∏ñ‡∏ô‡∏ô',
  '‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•',
  '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï',
  '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î',
  '‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå',
  '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û',
]

// Create workbook
const workbook = xlsx.utils.book_new()

// Create worksheet with header row
const worksheet = xlsx.utils.aoa_to_sheet([columns])

// Set column widths
const columnWidths = [
  { wch: 15 }, // ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
  { wch: 20 }, // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
  { wch: 18 }, // ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
  { wch: 10 }, // ‡πÄ‡∏û‡∏®
  { wch: 15 }, // ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á
  { wch: 15 }, // ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
  { wch: 20 }, // ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
  { wch: 12 }, // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô
  { wch: 12 }, // ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
  { wch: 15 }, // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£
  { wch: 25 }, // Email
  { wch: 25 }, // Email Build
  { wch: 25 }, // PassWord E-mail Buildme
  { wch: 12 }, // ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
  { wch: 12 }, // ‡∏ß‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏á‡∏≤‡∏ô
  { wch: 12 }, // ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
  { wch: 12 }, // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô
  { wch: 40 }, // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
  { wch: 15 }, // ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô
  { wch: 15 }, // ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£
  { wch: 12 }, // ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
  { wch: 10 }, // ‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà
  { wch: 10 }, // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
  { wch: 15 }, // ‡∏ã‡∏≠‡∏¢/‡∏ï‡∏£‡∏≠‡∏Å
  { wch: 10 }, // ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà
  { wch: 20 }, // ‡∏ñ‡∏ô‡∏ô
  { wch: 15 }, // ‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•
  { wch: 15 }, // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï
  { wch: 15 }, // ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
  { wch: 12 }, // ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
  { wch: 30 }, // ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
]

worksheet['!cols'] = columnWidths

// Add example rows (optional - can be removed)
const exampleRows = [
  [
    'AC00010', // ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
    '‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£', // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
    '1234567890123', // ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
    '‡∏ä‡∏≤‡∏¢', // ‡πÄ‡∏û‡∏®
    '‡∏¢‡∏∏‡∏ó‡∏ò‡∏ô‡∏≤', // ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á
    '(‡πÄ‡∏≠‡πá‡∏°)', // ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
    'John Doe', // ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
    '‡πÄ‡∏≠‡πá‡∏°', // ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô
    '1990-05-20', // ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
    '0812345678', // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£
    'john.doe@example.com', // Email
    'john.doe@buildmeup.com', // Email Build
    'password123', // PassWord E-mail Buildme
    '2024-01-15', // ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
    '2024-04-15', // ‡∏ß‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏á‡∏≤‡∏ô
    '', // ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
    '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà', // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô
    '123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡πÄ‡∏Ç‡∏ï‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£ 10110', // ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
    '', // ‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô
    '', // ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£
    '', // ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
    '', // ‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà
    '123', // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà
    '‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó 39', // ‡∏ã‡∏≠‡∏¢/‡∏ï‡∏£‡∏≠‡∏Å
    '', // ‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà
    '‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó', // ‡∏ñ‡∏ô‡∏ô
    '‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô', // ‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•
    '‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô', // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡πÄ‡∏Ç‡∏ï
    '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', // ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
    '10110', // ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
    '', // ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
  ],
]

// Add example rows to worksheet
xlsx.utils.sheet_add_aoa(worksheet, exampleRows, { origin: -1 })

// Add worksheet to workbook
xlsx.utils.book_append_sheet(workbook, worksheet, 'Employee Data')

// Create templates directory if it doesn't exist
const templatesDir = path.join(__dirname, '../../templates')
if (!fs.existsSync(templatesDir)) {
  fs.mkdirSync(templatesDir, { recursive: true })
}

// Write file
const outputPath = path.join(templatesDir, 'employee_import_template.xlsx')
xlsx.writeFile(workbook, outputPath)

console.log('‚úÖ Excel template created successfully!')
console.log(`üìÅ File location: ${outputPath}`)
console.log(`üìä Columns: ${columns.length}`)
console.log(`üìù Example rows: ${exampleRows.length}`)
